---
title: "Untitled"
author: "Arnoldo Bustos"
date: "18 de noviembre de 2018"
output: pdf_document
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

```

```{r}

here::set_here();

setwd("C:/Users/escan/OneDrive/Documentos/Grizzly/Matematica Actuarial I/Proyecto")

here = "C:/Users/escan/OneDrive/Documentos/Grizzly/Matematica Actuarial I/Proyecto"

trabajadores <- readxl::read_excel(paste0(here, "/Datos_Proyecto_v2.xlsx"), sheet = "Trabajadores")

colnames(trabajadores) <- c("ID", "FEC_INGRESO", "SEXO", "FEC_NAC", "SALARIO")

mortalidad <- readxl::read_excel(paste0(here,"/Datos_Proyecto_v2.xlsx"), sheet = "Mortalidad")

jubilados <- readxl::read_excel(paste0(here,"/Datos_Proyecto_v2.xlsx"), sheet = "Jubilados")

hoy <- as.numeric(as.Date("2017-12-31"))

trabajadores <- dplyr::mutate(trabajadores, FEC_INGRESO = as.Date(FEC_INGRESO, format = "%d-%m-%y"))

trabajadores <- dplyr::mutate(trabajadores, FEC_NAC = as.Date(FEC_NAC,  format = "%d-%m-%y"))

trabajadores <- dplyr::mutate(trabajadores, FEC_PENSION = as.Date(paste0(as.character(as.numeric(format(FEC_NAC,"%Y")) + 65), format(FEC_NAC,"-%m-%d"))) )

trabajadores$FECINGRESO[1]

yearVec = 2001:2030

errorHB <- function(k){
  year = as.character.numeric_version(k)
  a <- as.numeric(as.Date("2000-04-06"))
  b <- as.numeric(as.Date(paste0(year,"-04-06")))
  c <- as.numeric(as.Date(paste0(year,"-04-05")))
  d = ((b-a)/365.25) - floor((b-a)/365.25)
  e = ((c-a)/365.25) - floor((c-a)/365.25)
  f = (d+e)/2  
}

errorVec <- Vectorize(errorHB)(yearVec)
errorVec

a = as.Date( "1997-12-26" )
as.numeric(format(a,"%Y")) + 65
format(a,"%d-%m-")
format(a,"%m")

```